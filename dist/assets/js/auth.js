!function(){"use strict";var __webpack_modules__={"./src/assets/js/auth.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _auth_adminAuth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./auth/adminAuth.js */ "./src/assets/js/auth/adminAuth.js");\n\n\ndocument.addEventListener(\'DOMContentLoaded\',()=>{\n    new _auth_adminAuth_js__WEBPACK_IMPORTED_MODULE_0__["default"]();\n})\n\n//# sourceURL=webpack://vitaliy.wp.dev/./src/assets/js/auth.js?')},"./src/assets/js/auth/adminAuth.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\nclass AdminAuth {\n    constructor() {\n        this.apiUrl = 'https://gameserver2.kemo.ru/api/admin/login-token';\n        this.tokenKey = 'admin_token';\n        this.expireKey = 'admin_token_expires';\n        this.form = document.getElementById('auth_form');\n        this.loginInput = document.getElementById('auth_login');\n        this.passInput = document.getElementById('auth_pass');\n\n        if (!this.form) {\n            console.info('[AUTH] Не на странице авторизации. Форма отсутствует.');\n            // return; // прерываем инициализацию\n        }else{\n            this.init();\n        }\n\n    }\n\n    init() {\n        this.form.addEventListener('submit', (e) => {\n            // console.log(this.form);\n            e.preventDefault();\n            this.login();\n        });\n    }\n\n    async login() {\n        const password = this.passInput.value.trim();\n\n        if (!password) {\n            alert('Введите пароль');\n            return;\n        }\n\n        try {\n            const response = await fetch(this.apiUrl, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ password })\n            });\n\n            const result = await response.json();\n\n            if (result.data?.success) {\n                const token = result.data.token;\n                const expires = Date.now() + result.data.expires_in * 1000;\n\n                localStorage.setItem(this.tokenKey, token);\n                localStorage.setItem(this.expireKey, expires);\n\n                console.log('[AUTH] Авторизация успешна. Токен сохранён');\n                window.location.href = '/admin.html'; // или нужная страница\n            } else {\n                alert(result.data.message || 'Ошибка авторизации');\n            }\n\n        } catch (error) {\n            console.error('[AUTH] Ошибка при авторизации:', error);\n            alert('Ошибка подключения к серверу');\n        }\n    }\n\n    static logout() {\n        localStorage.removeItem('admin_token');\n        localStorage.removeItem('admin_token_expires');\n        window.location.href = '/auth.html';\n    }\n\n    static isAuthenticated() {\n        const token = localStorage.getItem('admin_token');\n        const expires = localStorage.getItem('admin_token_expires');\n        return token && expires && Date.now() < Number(expires);\n    }\n\n    static getToken() {\n        return localStorage.getItem('admin_token');\n    }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (AdminAuth);\n\n\n//# sourceURL=webpack://vitaliy.wp.dev/./src/assets/js/auth/adminAuth.js?")}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];return void 0!==n||(n=__webpack_module_cache__[e]={exports:{}},__webpack_modules__[e](n,n.exports,__webpack_require__)),n.exports}__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/assets/js/auth.js")}();