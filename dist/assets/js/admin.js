!function(){"use strict";var __webpack_modules__={"./src/assets/js/admin.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _admin_formHandler_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./admin/formHandler.js */ \"./src/assets/js/admin/formHandler.js\");\n/* harmony import */ var _admin_searchHandler_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./admin/searchHandler.js */ \"./src/assets/js/admin/searchHandler.js\");\n/* harmony import */ var _admin_sessionPool_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./admin/sessionPool.js */ \"./src/assets/js/admin/sessionPool.js\");\n\n\n\n\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  new _admin_formHandler_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]('.admin_form_add');\n  new _admin_searchHandler_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]('.admin_form_search');\n  const playerPoll = new _admin_sessionPool_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]();\n\n  //–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª–∏–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞\n\n  document.getElementById('admin_container').addEventListener('click', async (event) => {\n    const target = event.target;\n\n    if (!target.closest('#admin_container')) {\n      return;\n    }\n\n    //—Å—Ç–∞—Ä—Ç\n    else if (target.classList.contains('start')) {\n      const player_token = target.closest('li').dataset.token;\n      const session_token = target.closest('.control')?.dataset?.session;\n      await playerPoll.startSession(session_token);\n\n      //—Å—Ç–æ–ø\n    } else if (target.classList.contains('stop')) {\n      await playerPoll.stopActiveSession();\n\n      //—Å–±—Ä–æ—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n    } else if (target.classList.contains('reset')) {\n      playerPoll.loadPool();\n    }\n\n\n    // else if (target.closest('li')) {\n    //   const token = target.closest('li').dataset.token;\n    //   playerPoll.addToPool(token);\n    // }\n\n  });\n\n});\njQuery(document).ready(function ($) {\n  const $form = $('[data-form]');\n  const $toggle = $('[data-register]');\n\n  // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ\n  $form.hide();\n\n  // –ü–æ –∫–ª–∏–∫—É –ø–æ \"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è\" ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Ñ–æ—Ä–º—ã\n  $toggle.on('click', function () {\n    $form.slideToggle(300); // –ü–ª–∞–≤–Ω–æ–µ —Å–∫—Ä—ã—Ç–∏–µ/–ø–æ–∫–∞–∑\n  });\n});\n\n\n//# sourceURL=webpack://vitaliy.wp.dev/./src/assets/js/admin.js?")},"./src/assets/js/admin/formHandler.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _player_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./player.js */ \"./src/assets/js/admin/player.js\");\n/* harmony import */ var _sessionPool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sessionPool.js */ \"./src/assets/js/admin/sessionPool.js\");\n/* harmony import */ var sweetalert2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sweetalert2 */ \"./node_modules/sweetalert2/dist/sweetalert2.all.js\");\n\n\n\n\n/**\n * –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞\n */\nclass PlayerFormHandler {\n    constructor(formSelector) {\n        this.form = document.querySelector(formSelector);\n        if (!this.form) throw new Error(`–§–æ—Ä–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: ${formSelector}`);\n        this.form.addEventListener('submit', this.handleSubmit.bind(this));\n        this.setupBadgeIdInputListener();\n    }\n\n    /**\n     * —Å–∞–±–º–∏—Ç —Ñ–æ—Ä–º—ã\n     * @param {*} event \n     * @returns \n     */\n    async handleSubmit(event) {\n        event.preventDefault();\n        const badgeId = this.form.querySelector('#player_id')?.value.trim();\n        const name = this.form.querySelector('#player_name')?.value.trim();\n        const telegram = this.form.querySelector('#player_telegram')?.value.trim();\n\n        if (!badgeId || !name) {\n            // alert('ID –Ω–∞ –±–µ–π–¥–∂–µ –∏ –∏–º—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã.');\n            sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                icon: 'warning', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                title: 'ID –Ω–∞ –±–µ–π–¥–∂–µ –∏ –∏–º—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã.',\n                text: '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –ø–æ–ª—è',\n            });\n            return;\n        }\n\n        const submitButton = this.form.querySelector('button[type=\"submit\"]');\n        submitButton.disabled = true;\n        submitButton.textContent = '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ...';\n\n        try {\n            const player = await _player_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].register(badgeId, name, telegram || null);\n            console.log(player?.token);\n\n            if (player && player.name) {\n                // alert(`–ò–≥—Ä–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${player.name}`);\n                sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                    icon: 'success', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                    title: '–í—ã–ø–æ–ª–Ω–µ–Ω–æ',\n                    text: `–ò–≥—Ä–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${player.name} –∏ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –æ—á–µ—Ä–µ–¥—å`,\n                });\n                this.form.reset();\n            } else {\n                // alert('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞.');\n                sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                    icon: 'error', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                    title: '–û—à–∏–±–∫–∞',\n                    text: `–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞.`,\n                });\n            }\n        } catch (error) {\n            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞:', error);\n            // alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');\n            sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                icon: 'error', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                title: '–û—à–∏–±–∫–∞',\n                text: `–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.`,\n            });\n        } finally {\n            submitButton.disabled = false;\n            submitButton.textContent = '–î–æ–±–∞–≤–∏—Ç—å';\n        }\n    }\n\n    /**\n     * —Å–ª—É—à–∞–µ–º –≤–≤–æ–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ id –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.\n     */\n    async setupBadgeIdInputListener() {\n        const badgeIdInput = this.form.querySelector('#player_id');\n\n        badgeIdInput.addEventListener('input', async (event) => {\n            const badgeId = event.target.value.trim();\n\n            if (badgeId.length === 4) {\n                const existingPlayer = _player_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getPlayerByBadgeId(badgeId);\n                if (existingPlayer) {\n                    const shouldReRegister = await sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                        title: '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ',\n                        text: `–ò–≥—Ä–æ–∫ \"${existingPlayer.name}\" –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ.\\n–•–æ—Ç–∏—Ç–µ –≤—Å—Ç–∞—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å –ø–æ–≤—Ç–æ—Ä–Ω–æ?`,\n                        icon: 'question',\n                        showCancelButton: true,\n                        confirmButtonText: '–î–∞',\n                        cancelButtonText: '–û—Ç–º–µ–Ω–∞',\n                    });\n\n                    // const shouldReRegister = confirm(\n                    //     `–ò–≥—Ä–æ–∫ \"${existingPlayer.name}\" –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ.\\n–•–æ—Ç–∏—Ç–µ –≤—Å—Ç–∞—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å –ø–æ–≤—Ç–æ—Ä–Ω–æ?`\n                    // );\n\n                    if (shouldReRegister) {\n                        try {\n                            const addResult = await _sessionPool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].addToPool(existingPlayer.player_token);\n                            console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ø—É–ª:', addResult);\n\n                            // 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—É–ª\n                            const poolInstance = new _sessionPool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n                            await poolInstance.loadPool();\n                        } catch (error) {\n                            console.error('–û—à–∏–±–∫–∞ –≤ —Ü–µ–ø–æ—á–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞:', error);\n                            throw error; // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –¥–∞–ª—å—à–µ –∏–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º\n                        }\n                    }\n                }\n            }\n        });\n    }\n\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (PlayerFormHandler);\n\n\n//# sourceURL=webpack://vitaliy.wp.dev/./src/assets/js/admin/formHandler.js?")},"./src/assets/js/admin/player.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sessionPool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./sessionPool.js */ \"./src/assets/js/admin/sessionPool.js\");\n/* harmony import */ var sweetalert2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sweetalert2 */ \"./node_modules/sweetalert2/dist/sweetalert2.all.js\");\n\n\n\n/**\n * –∫–ª–∞—Å—Å –ø—Ä–æ—Ñ–∏–ª—è –∏–≥—Ä–æ–∫–∞\n */\nclass Player {\n    static BASE_URL = 'https://gameserver2.kemo.ru/api';\n\n    constructor(playerToken = null) {\n        this.playerToken = playerToken;\n    }\n\n    /**\n     * –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞\n     * @param {*} badgeId \n     * @param {*} name \n     * @param {*} telegramNick \n     * @returns \n     */\n\n    static async register(badgeId, name, telegramNick = null) {\n        const payload = {\n            badge_id: String(badgeId),\n            name: name\n        };\n\n        if (telegramNick) {\n            payload.telegram_nick = telegramNick;\n        }\n\n        const response = await fetch(`${Player.BASE_URL}/players`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(payload)\n        });\n\n        const result = await response.json();\n\n        if (result.data.success) {\n            const player = new Player(result.data.player_token);\n            player.badgeId = result.data.badge_id;\n            player.name = result.data.name;\n            player.telegramNick = result.data.telegram_nick;\n            player.token = result.data.player_token;\n\n            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ localStorage\n            Player.savePlayerToLocalStorage({\n                badge_id: player.badgeId,\n                name: player.name,\n                player_token: player.token,\n                telegram_nick: player.telegramNick\n            });\n\n            console.log('–ò–≥—Ä–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', player);\n\n            //—Å—Ç–∞–≤–∏–º –≤ –æ—á–µ—Ä–µ–¥—å\n            const pool = await _sessionPool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].addToPool(result.data.player_token);\n\n            if (pool && pool.success) {\n                const poolInstance = new _sessionPool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\n                await poolInstance.loadPool();\n            }\n            return player;\n\n        } else if (result.data.success == false && result.data.code == 'DUPLICATE_BADGE_ID') {\n            console.warn(result.data.message);\n            console.log(result);\n            // alert('–û—à–∏–±–∫–∞: ' + result.data.message);\n\n            sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                // icon: 'error', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                // title: '–û—à–∏–±–∫–∞',\n                text: result.data.message,\n            });\n\n            //—Å—Ç–∞–≤–∏–º –≤ –æ—á–µ—Ä–µ–¥—å\n            // const pool = await PlayerPool.addToPool(playerToken);\n\n            // if (pool && pool.success) {\n            // const poolInstance = new PlayerPool(); \n            // await poolInstance.loadPool();\n            // }\n\n            return null;\n\n        } else if (result.data.code === 'VALIDATION_ERROR') {\n            // alert('–ù–µ–ø—Ä–æ–π–¥–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è' + result.data.details)\n             sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                icon: 'error', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                title: '–ù–µ–ø—Ä–æ–π–¥–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è',\n                text: result.data.message,\n            });\n            console.warn('üîç –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:', result.data.details);\n            return null;\n\n        } else {\n            // alert(\"–û—à–∏–±–∫–∞: \" + result.data.message);\n              sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                icon: 'error', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                title: '–û—à–∏–±–∫–∞',\n                text: result.data.message,\n            });\n            console.warn('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', result.data.message)\n            return null;\n        }\n    }\n\n    /**\n     *  –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ localStorage\n     * @param {*} playerData \n     */\n    static savePlayerToLocalStorage(playerData) {\n        try {\n            const players = Player.getPlayersFromLocalStorage();\n            const existingPlayerIndex = players.findIndex(p => p.badge_id === playerData.badge_id);\n\n            if (existingPlayerIndex !== -1) {\n                players[existingPlayerIndex] = playerData;\n            } else {\n                players.push(playerData);\n            }\n\n            localStorage.setItem('registeredPlayers', JSON.stringify(players));\n        } catch (error) {\n            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–≥—Ä–æ–∫–∞:', error);\n        }\n    }\n\n    /**\n     * –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –∏–∑ localStorage\n     * @returns \n     */\n    static getPlayersFromLocalStorage() {\n        try {\n            const playersJSON = localStorage.getItem('registeredPlayers');\n            return playersJSON ? JSON.parse(playersJSON) : [];\n        } catch (error) {\n            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–≥—Ä–æ–∫–æ–≤:', error);\n            return [];\n        }\n    }\n\n    /**\n     * –ü–æ–ª—É—á–∞–µ–º –∏–≥—Ä–æ–∫–∞ –ø–æ badge_id\n     * @param {*} badgeId \n     * @returns \n     */\n    static getPlayerByBadgeId(badgeId) {\n        const players = Player.getPlayersFromLocalStorage();\n        return players.find(player => player.badge_id === String(badgeId));\n    }\n\n    /**\n     * –£–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –∏–∑ localStorage –ø–æ badge_id\n     * @param {*} badgeId \n     * @returns \n     */\n    static removePlayerFromLocalStorage(badgeId) {\n        try {\n            const players = Player.getPlayersFromLocalStorage();\n            const updatedPlayers = players.filter(player => player.badge_id !== String(badgeId));\n            localStorage.setItem('registeredPlayers', JSON.stringify(updatedPlayers));\n            return true;\n        } catch (error) {\n            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–≥—Ä–æ–∫–∞:', error);\n            return false;\n        }\n    }\n\n    /**\n     * –ø–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞\n     * @param {*} badgeId \n     */\n    static async search(badgeId) {\n\n        const response = await fetch(`${Player.BASE_URL}/players/badge/${badgeId}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n        })\n        const result = await response.json();\n        return result;\n    }\n\n    //  –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ\n    async fetchProfile() {\n        if (!this.playerToken) {\n            throw new Error('üîí –¢–æ–∫–µ–Ω –∏–≥—Ä–æ–∫–∞ –Ω–µ –∑–∞–¥–∞–Ω.');\n        }\n\n        const response = await fetch(`${Player.BASE_URL}/players/me`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-Player-Token': this.playerToken,\n                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å X-Game-Token, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è\n            }\n        });\n\n        const result = await response.json();\n\n        if (result.data?.success) {\n            console.log('üìÑ –ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞:', result.data);\n            return result.data;\n        } else {\n            console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è:', result.data?.message);\n            return null;\n        }\n    }\n}\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Player);\n\n//# sourceURL=webpack://vitaliy.wp.dev/./src/assets/js/admin/player.js?")},"./src/assets/js/admin/searchHandler.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _player_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./player.js */ \"./src/assets/js/admin/player.js\");\n/* harmony import */ var _sessionPool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sessionPool.js */ \"./src/assets/js/admin/sessionPool.js\");\n/* harmony import */ var sweetalert2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sweetalert2 */ \"./node_modules/sweetalert2/dist/sweetalert2.all.js\");\n\n\n\n\n/**\n * –ø–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞\n */\nclass PlayerSearchHandler {\n    constructor(formSelector) {\n        this.form = document.querySelector(formSelector);\n        if (!this.form) throw new Error(`–§–æ—Ä–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: ${formSelector}`);\n        this.form.addEventListener('submit', this.searchSubmit.bind(this));\n    }\n\n    async searchSubmit(event) {\n        event.preventDefault();\n        const badgeId = this.form.querySelector('#search_player_id')?.value.trim();\n\n        if (!badgeId) {\n            // alert('ID –Ω–∞ –±–µ–π–¥–∂–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.');\n            sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                icon: 'warning', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                title: '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ',\n                text: `ID –Ω–∞ –±–µ–π–¥–∂–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.`,\n            });\n            return;\n        }\n\n        const submitButton = this.form.querySelector('button[type=\"submit\"]');\n        submitButton.disabled = true;\n        submitButton.textContent = '–ü–æ–∏—Å–∫...';\n\n        const player = await _player_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].search(badgeId);\n        console.log(player);\n\n        if (player.data.success === true && player.data.exists === true) {\n            const token = player.data.player.player_token;\n            const container = document.getElementById('admin_container');\n            const allItems = container.querySelectorAll('li');\n\n            let found = false;\n            allItems.forEach(li => {\n                if (li.dataset.token === token) {\n                    li.style.display = 'grid'; // –ø–æ–∫–∞–∑–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–π\n                    found = true;\n                } else if (!li.classList.contains('reset')) {\n                    li.style.display = 'none'; // —Å–∫—Ä—ã—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ (–Ω–µ —Å–±—Ä–æ—Å)\n                }\n            });\n\n            if (!found) {\n                // alert('–ò–≥—Ä–æ–∫ –Ω–∞–π–¥–µ–Ω, –Ω–æ —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂—ë–Ω.');\n                console.log(player.data.player)\n                const name = player.data.player.name;\n                const player_token = player.data.player.player_token;\n\n                const shouldReRegister = await sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                    title: '–í–æ–ø—Ä–æ—Å',\n                    text: `–ò–≥—Ä–æ–∫ \"${name}\" –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ.\\n–•–æ—Ç–∏—Ç–µ –≤—Å—Ç–∞—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å?`,\n                    icon: 'question',\n                    showCancelButton: true,\n                    confirmButtonText: '–î–∞',\n                    cancelButtonText: '–û—Ç–º–µ–Ω–∞',\n                });\n\n\n                if (shouldReRegister) {\n                    try {\n                        const addResult = await _sessionPool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].addToPool(player_token);\n                        console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ø—É–ª:', addResult);\n\n                        // 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—É–ª\n                        const poolInstance = new _sessionPool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n                        await poolInstance.loadPool();\n                    } catch (error) {\n                        console.error('–û—à–∏–±–∫–∞ –≤ —Ü–µ–ø–æ—á–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞:', error);\n                        throw error; // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –¥–∞–ª—å—à–µ –∏–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º\n                    }\n                }\n\n                submitButton.disabled = false;\n                submitButton.textContent = '–ù–∞–π—Ç–∏';\n                return;\n            }\n\n            // –¥–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞, –µ—Å–ª–∏ –µ—ë –µ—â—ë –Ω–µ—Ç\n            if (!container.querySelector('li.reset')) {\n                const resetBtn = `\n                    <li class=\"reset\" style=\"cursor:pointer;\">\n                        <span style=\"pointer-events:none;\">–°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</span>\n                    </li>`;\n                container.insertAdjacentHTML('beforeend', resetBtn);\n            }\n\n        } else if (player.data.success === true && player.data.exists === false) {\n            // alert('–ò–≥—Ä–æ–∫ —Å —Ç–∞–∫–∏–º badge_id –Ω–µ –Ω–∞–π–¥–µ–Ω.');\n            sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                icon: 'warning', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                title: '–ò–≥—Ä–æ–∫ —Å —Ç–∞–∫–∏–º badge_id –Ω–µ –Ω–∞–π–¥–µ–Ω.',\n                text: player.data.message,\n            });\n\n        } else {\n            // alert(\"–û—à–∏–±–∫–∞: \" + player.data.message);\n            console.warn(player);\n\n              sweetalert2__WEBPACK_IMPORTED_MODULE_2__.fire({\n                icon: 'error', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                title: '–û—à–∏–±–∫–∞',\n                text: player.data.message,\n            });\n        }\n\n        this.form.reset();\n        submitButton.disabled = false;\n        submitButton.textContent = '–ù–∞–π—Ç–∏';\n    }\n\n\n    createResetButton(container) {\n        if (!container.querySelector('.reset')) {\n            const resetBtn = document.createElement('li');\n            resetBtn.className = 'reset';\n            resetBtn.style.cursor = 'pointer';\n            resetBtn.innerHTML = `<span style=\"pointer-events:none;\">–°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</span>`;\n            container.appendChild(resetBtn);\n        }\n    }\n\n    // async searchSubmit(event) {\n    //     event.preventDefault();\n    //     const badgeId = this.form.querySelector('#search_player_id')?.value.trim();\n\n    //     if (!badgeId) {\n    //         alert('ID –Ω–∞ –±–µ–π–¥–∂–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.');\n    //         return;\n    //     }\n\n    //     const submitButton = this.form.querySelector('button[type=\"submit\"]');\n    //     submitButton.disabled = true;\n    //     submitButton.textContent = '–ü–æ–∏—Å–∫...';\n\n    //     const player = await Player.search(badgeId);\n    //     console.log(player);\n\n    //     if (player.data.success == true && player.data.exists == true) {\n    //         const container = document.getElementById('admin_container');\n    //         const list = `\n    //             <li>\n    //                 <span></span>\n    //                 <span>${player.data.player.badge_id}</span>\n    //                 <span>${player.data.player.name}</span>\n    //                 <div class=\"control\">\n    //                     <span></span>\n    //                     <span></span>\n    //                 </div>\n    //             </li>  \n    //             <li class=\"reset\" style=\"cursor:pointer;\">\n    //                 <span style=\"pointer-events:none;\">–°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</span>\n    //             </li>`;\n    //         container.innerHTML = '';\n    //         container.insertAdjacentHTML('beforeend', list);\n    //     } else if (player.data.success == true && player.data.exists == false) {\n    //         alert('–ò–≥—Ä–æ–∫ —Å —Ç–∞–∫–∏–º badge_id –Ω–µ –Ω–∞–π–¥–µ–Ω')\n    //     } else {\n    //         alert(\"–û—à–∏–±–∫–∞: \" + player.data.message);\n    //         console.warn(player)\n    //     }\n\n    //     this.form.reset();\n    //     submitButton.disabled = false;\n    //     submitButton.textContent = '–ù–∞–π—Ç–∏';\n    // }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (PlayerSearchHandler);\n\n\n//# sourceURL=webpack://vitaliy.wp.dev/./src/assets/js/admin/searchHandler.js?")},"./src/assets/js/admin/sessionPool.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _auth_adminAuth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../auth/adminAuth.js */ \"./src/assets/js/auth/adminAuth.js\");\n/* harmony import */ var sweetalert2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sweetalert2 */ \"./node_modules/sweetalert2/dist/sweetalert2.all.js\");\n\n\n\nclass PlayerPool {\n    static BASE_URL = 'https://gameserver2.kemo.ru/api';\n    static WS_URL = 'wss://gameserver2.kemo.ru/ws';\n    static gameToken = 'gAmEToKeN1';\n    static adminKey = 'Q3z8vKp9N2w5R6s1Xy7L';\n    static containerSelector = 'admin_container';\n\n\n    constructor() {\n        this.container = document.getElementById(PlayerPool.containerSelector);\n        this.loadPool();\n        this.ws = null;\n        this.sessionActive = false;\n        this.startOnHover();\n    }\n\n    /**\n     * –∑–∞–≥—Ä—É–∑–∫–∞ –ø—É–ª–∞\n     * @returns \n     */\n    async loadPool() {\n        const token = _auth_adminAuth_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getToken();\n\n        if (!token) {\n            console.error('[AUTH] –ù–µ—Ç —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');\n            window.location.href = '/auth.html';\n            return;\n        }\n        // ?status=started,pending,completed, stopped_by_admin, abandoned\n        const response = await fetch(`${PlayerPool.BASE_URL}/admin/games/${PlayerPool.gameToken}/pool`, {\n            method: 'GET',\n            headers: {\n                'Authorization': `Bearer ${token}`,\n                // 'X-Admin-API-Key': PlayerPool.adminKey,\n                'Content-Type': 'application/json'\n            }\n        });\n        if (!response.ok) {\n            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—É–ª–∞');\n            return;\n        }\n        console.log(response)\n        const pool = await response.json();\n        this.render(pool);\n    }\n\n    /**\n     * —Ä–µ–Ω–¥–µ—Ä –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤, (–ø–µ—Ä–≤–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–ª–∏ –∞–ø–¥–µ–π—Ç)\n     * @param {*} pool \n     */\n    render(pool) {\n        this.container.innerHTML = '';\n        let pendingsCount = 0;\n\n        // –ü–æ—Ä—è–¥–æ–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ (–º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏)\n        const statusOrder = [\n            'started',       // 1 –º–µ—Å—Ç–æ - —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ\n            'pending',       // 2 –º–µ—Å—Ç–æ\n            'stopped_by_admin', // 3 –º–µ—Å—Ç–æ\n            'completed'      // 4 –º–µ—Å—Ç–æ - –≤ –∫–æ–Ω—Ü–µ\n        ];\n\n        // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–µ—Å—Å–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–∞—à–µ–º—É –ø–æ—Ä—è–¥–∫—É\n        // const sortedSessions = [...pool.data.sessions].sort((a, b) => {\n        //     const aIndex = statusOrder.indexOf(a.status);\n        //     const bIndex = statusOrder.indexOf(b.status);\n\n        //     // –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –Ω–µ —É–∫–∞–∑–∞–Ω –≤ –ø–æ—Ä—è–¥–∫–µ - —Å—Ç–∞–≤–∏–º –≤ –∫–æ–Ω–µ—Ü\n        //     return (aIndex === -1 ? Infinity : aIndex) - (bIndex === -1 ? Infinity : bIndex);\n        // });\n        const sessions = [...pool.data.sessions];\n\n        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏)\n        const sortByStartedAtAsc = (a, b) => {\n            const aTime = new Date(a.started_at).getTime();\n            const bTime = new Date(b.started_at).getTime();\n            return aTime - bTime; // –º–µ–Ω—å—à–µ–µ –≤—Ä–µ–º—è ‚Äî —Ä–∞–Ω—å—à–µ\n        };\n\n        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º (–ø–æ —É–±—ã–≤–∞–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏)\n        const sortByStartedAtDesc = (a, b) => {\n            const aTime = new Date(a.started_at).getTime();\n            const bTime = new Date(b.started_at).getTime();\n            return bTime - aTime; // –±–æ–ª—å—à–µ–µ –≤—Ä–µ–º—è ‚Äî —Ä–∞–Ω—å—à–µ –≤ —Å–ø–∏—Å–∫–µ\n        };\n\n        // –í—ã–±–∏—Ä–∞–µ–º —Å–µ—Å—Å–∏–∏ \"started\" –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º\n        const startedSessions = sessions\n            .filter(session => session.status === 'pending')\n            .sort(sortByStartedAtAsc);\n\n        // –í—ã–±–∏—Ä–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º\n        const otherSessions = sessions\n            .filter(session => session.status !== 'pending')\n            .sort(sortByStartedAtDesc);\n\n        // –û–±—ä–µ–¥–∏–Ω—è–µ–º –º–∞—Å—Å–∏–≤—ã: —Å–Ω–∞—á–∞–ª–∞ started, –ø–æ—Ç–æ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ\n        const sortedSessions = [...startedSessions, ...otherSessions];\n\n\n\n\n        // console.log('–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏:', sortedSessions);\n\n        // –†–µ–Ω–¥–µ—Ä–∏–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫\n        sortedSessions.forEach((session, index) => {\n            index++;\n            const date = new Date(session.started_at);\n            const hours = date.getHours();\n            const minutes = date.getMinutes();\n            const formattedTime = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;\n            // console.log(session)\n\n            let controls = '';\n\n            if (session.status == 'pending') {\n                pendingsCount++;\n                controls = `<div class=\"control\" data-session=${session.session_token}>\n                            <span>–û—á–µ—Ä–µ–¥—å ${pendingsCount}</span>\n                            <button type=\"button\" class=\"start\"></button>\n                        </div>`;\n            } else if (session.status == 'completed') {\n                controls = `<div class=\"control\" data-session=${session.session_token}>\n                            <span class=\"coin\">${session.best_session_score}</span>\n                            <span class=\"time\">${formattedTime}</span>\n                        </div>`;\n            } else if (session.status == 'started') {\n                controls = `<div class=\"control\" data-session=${session.session_token}>\n                            <span>–ò–¥–µ—Ç –∏–≥—Ä–∞</span>\n                            <button type=\"button\" class=\"stop\"></button>\n                        </div>`;\n            } else if (session.status == 'stopped_by_admin') {\n                controls = `<div class=\"control\" data-session=${session.session_token}>\n                            <span class=\"coin\">${session.best_session_score}</span>\n                            <span class=\"time\">${formattedTime}</span>\n                        </div>`;\n            }\n\n            const html = `\n                <li class=\"${session.status == 'started' ? 'active' : ''}\" data-token=${session.player_token} data-status=${session.status}>\n                    <span>${index}</span>\n                    <span>${session.badge_id}</span>\n                    <span>${session.name}</span>\n                    ${controls}\n                </li>`;\n            this.container.insertAdjacentHTML('beforeend', html);\n        });\n    }\n\n    /**\n     * –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –≤ –ø—É–ª (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ \n     * –∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –æ–∫–Ω—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞)\n     * @param {*} playerToken \n     * @returns \n     */\n\n    static async addToPool(playerToken) {\n        const token = _auth_adminAuth_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getToken();\n\n        if (!token) {\n            console.error('[AUTH] –ù–µ—Ç —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');\n            window.location.href = '/auth.html';\n            return;\n        }\n\n        if (!playerToken) {\n            console.error('–¢–æ–∫–µ–Ω –∏–≥—Ä–æ–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ø—É–ª');\n            return null;\n        }\n\n        const body = {\n            player_token: playerToken\n        };\n\n        try {\n            const response = await fetch(`${PlayerPool.BASE_URL}/admin/games/${PlayerPool.gameToken}/pool`, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                    // 'X-Admin-API-Key': PlayerPool.adminKey,\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(body)\n            });\n\n            const data = await response.json();\n\n            if (!data?.data?.success) {\n                // console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø—É–ª:', data.data.message);\n                 sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                // icon: 'error', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                title: '–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø—É–ª:',\n                text: data.data.message,\n            });\n                return data.data; // –í–µ—Ä–Ω—ë–º, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ALREADY_IN_POOL_OR_ACTIVE)\n            }\n\n            console.log('–ò–≥—Ä–æ–∫ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ø—É–ª:', data.data);\n            // alert(data.data.message)\n            sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                // icon: 'info', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                // title: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',\n                text: data.data.message,\n            });\n\n            return data.data; // –í–∫–ª—é—á–∞–µ—Ç session_token –∏ –ø—Ä–æ—á–µ–µ\n\n        } catch (error) {\n            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –ø—É–ª:', error);\n            return null;\n        }\n    }\n\n    /**\n     * —Å—Ç–∞—Ä—Ç —Å–µ—Å—Å–∏–∏ –∏–≥—Ä–æ–∫–∞. \n     * @param {*} sessionToken \n     * @returns \n     */\n    async startSession(sessionToken) {\n        if (!sessionToken) {\n            console.error('–¢–æ–∫–µ–Ω —Å–µ—Å—Å–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –∑–∞–ø—É—Å–∫–∞');\n            return null;\n        }\n\n        const stopButtonExists = this.container.querySelector('.stop');\n        if (stopButtonExists) {\n            const confirmStart = confirm('–£–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? –¢–µ–∫—É—â–∞—è –±—É–¥–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—á–∫–æ–≤.');\n            if (!confirmStart) {\n                console.log('–ó–∞–ø—É—Å–∫ –æ—Ç–º–µ–Ω—ë–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º');\n                return;\n            }\n        }\n\n        const token = _auth_adminAuth_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getToken();\n\n        if (!token) {\n            console.error('[AUTH] –ù–µ—Ç —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');\n            window.location.href = '/auth.html';\n            return;\n        }\n\n        try {\n            const response = await fetch(`${PlayerPool.BASE_URL}/admin/games/${PlayerPool.gameToken}/start`, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                    // 'X-Admin-API-Key': PlayerPool.adminKey,\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ session_token: sessionToken })\n            });\n\n            const data = await response.json();\n\n            if (data?.data?.success) {\n                sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                    // icon: 'info', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                    // title: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',\n                    text: data.data.message,\n                });\n                console.log('–°–µ—Å—Å–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–∞:', data.data.message);\n                // alert(data.data.message);\n                // –û–±–Ω–æ–≤–∏–º —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ \n                await this.loadPool();\n                // 3. –ó–∞–ø—É—Å–∫–∞–µ–º WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n                await this.connectWebSocket(sessionToken);\n                this.sessionActive = true;\n                return data.data;\n            } else {\n                console.warn('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Å—Å–∏–∏:', data.data.message);\n                sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                    // icon: 'info', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                    // title: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',\n                    text: data.data.message,\n                });\n\n                // alert(data.data.message);\n                return data.data;\n            }\n        } catch (error) {\n            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Å—Å–∏–∏:', error);\n            return null;\n        }\n    }\n\n    /**\n     * –û—Å—Ç–∞–≤–æ–≤–∫–∞ —Å–µ–∫—Ü–∏–∏ –ø–æ –∫–ª–∏–∫—É\n     */\n    async stopActiveSession() {\n        try {\n\n            const token = _auth_adminAuth_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getToken();\n\n            if (!token) {\n                console.error('[AUTH] –ù–µ—Ç —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');\n                window.location.href = '/auth.html';\n                return;\n            }\n\n            const response = await fetch(`${PlayerPool.BASE_URL}/admin/games/${PlayerPool.gameToken}/stop`, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                    //   'X-Admin-API-Key': PlayerPool.adminKey,\n                    'Content-Type': 'application/json'\n                }\n            });\n\n            const data = await response.json();\n\n            if (response.ok && data?.data?.success) {\n                // alert('–°–µ—Å—Å–∏—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');\n\n                sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                    // icon: 'info', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                    // title: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',\n                    text: '–°–µ—Å—Å–∏—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º',\n                });\n\n                console.log(data.data.message);\n                await this.loadPool();\n            } else {\n                console.warn(data.data?.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–µ—Å—Å–∏–∏');\n            }\n        } catch (error) {\n            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏:', error);\n        }\n    }\n\n\n    /**\n     * –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É\n     * @param {string} sessionToken \n     * @returns {Promise<void>}\n     */\n    connectWebSocket(sessionToken) {\n        return new Promise((resolve, reject) => {\n            const wsUrl = `${PlayerPool.WS_URL}?game_token=${PlayerPool.gameToken}&role=admin`;\n            this.ws = new WebSocket(wsUrl);\n\n            console.log('[WS] –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫:', wsUrl);\n\n            const authPayload = {\n                token: _auth_adminAuth_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getToken(),\n                admin_key: PlayerPool.adminKey\n            };\n\n            this.ws.onopen = () => {\n                if (this.ws.readyState === WebSocket.OPEN) {\n                    this.ws.send(JSON.stringify(authPayload));\n                    console.log('[WS] –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞');\n                }\n            };\n\n            this.ws.onmessage = (event) => {\n                const data = JSON.parse(event.data);\n                console.log('[WS] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ:', data);\n\n                switch (data.event) {\n                    case 'auth_ok':\n                        console.log('[WS] –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞');\n                        resolve();\n                        break;\n\n                    case 'auth_failed':\n                        console.error('[WS] –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', data.message);\n                        this.ws.close();\n                        reject(data.message);\n                        break;\n\n                    case 'round_completed':\n                        this.handleRoundCompleted(data.payload);\n                        this.loadPool();\n                        break;\n\n                    case 'game_completed':\n                        this.handleGameCompleted(data.payload);\n                        this.loadPool();\n                        // alert('–ò–≥—Ä–∞ –±—ã–ª–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞')\n                        sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                            // icon: 'info', // –∏–ª–∏ 'success', 'error', 'warning', 'question'\n                            // title: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',\n                            text: '–ò–≥—Ä–∞ –±—ã–ª–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞',\n                        });\n                        break;\n\n                    default:\n                        console.warn('[WS] –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ:', data.event);\n                }\n            };\n\n            this.ws.onerror = (error) => {\n                console.error('[WS] –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:', error);\n                reject(error);\n            };\n\n            this.ws.onclose = (event) => {\n                console.log(`[WS] –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ. –ö–æ–¥: ${event.code}, –ü—Ä–∏—á–∏–Ω–∞: ${event.reason}`);\n                this.sessionActive = false;\n            };\n        });\n    }\n\n    /**\n     * –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—É–Ω–¥–∞\n     * @param {object} payload \n     */\n    handleRoundCompleted(payload) {\n        console.log('[WS] –†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à–µ–Ω:', payload);\n    }\n\n    /**\n     * –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã\n     * @param {object} payload \n     */\n    handleGameCompleted(payload) {\n        console.log('[WS] –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞:', payload);\n\n        // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n        this.disconnectWebSocket();\n    }\n\n    /**\n     * –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç WebSocket\n     */\n    disconnectWebSocket() {\n        if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n            this.ws.close();\n            console.log('[WS] –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ');\n        }\n        this.sessionActive = false;\n    }\n\n    /**\n     * –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—É–ª –ø–æ –∫–Ω–æ–ø–∫–µ\n     */\n    startOnHover() {\n        document.addEventListener('click', async (event) => {\n            const li = event.target.closest('li[data-status]');\n            if (!li) return;\n\n            // –ï—Å–ª–∏ –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ ‚Äî –≤—ã—Ö–æ–¥–∏–º, –Ω–µ –º–µ—à–∞–µ–º\n            if (event.target.closest('button')) return;\n\n            const token = li.dataset.token;\n            console.log('–ö–ª–∏–∫ –ø–æ LI, token:', token);\n\n            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º SweetAlert2 —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º\n            const result = await sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire({\n                // title: '–î–æ–±–∞–≤–∏—Ç—å –≤ –ø—É–ª?',\n                text: '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –≤ –ø—É–ª?',\n                // icon: 'question',\n                showCancelButton: true,\n                confirmButtonText: '–î–∞',\n                cancelButtonText: '–û—Ç–º–µ–Ω–∞',\n            });\n\n            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª\n            if (result.isConfirmed) {\n                try {\n                    const addResult = await PlayerPool.addToPool(token);\n                    // console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç:', addResult);\n                    this.loadPool();\n                } catch (err) {\n                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –ø—É–ª:', err);\n                    await sweetalert2__WEBPACK_IMPORTED_MODULE_1__.fire('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞ –≤ –ø—É–ª.', 'error');\n                }\n            }\n        });\n    }\n\n\n}\n/* harmony default export */ __webpack_exports__[\"default\"] = (PlayerPool);\n\n//# sourceURL=webpack://vitaliy.wp.dev/./src/assets/js/admin/sessionPool.js?")},"./src/assets/js/auth/adminAuth.js":function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\nclass AdminAuth {\n    constructor() {\n        this.apiUrl = 'https://gameserver2.kemo.ru/api/admin/login-token';\n        this.tokenKey = 'admin_token';\n        this.expireKey = 'admin_token_expires';\n        this.form = document.getElementById('auth_form');\n        this.loginInput = document.getElementById('auth_login');\n        this.passInput = document.getElementById('auth_pass');\n\n        if (!this.form) {\n            console.info('[AUTH] –ù–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –§–æ—Ä–º–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.');\n            // return; // –ø—Ä–µ—Ä—ã–≤–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é\n        }else{\n            this.init();\n        }\n\n    }\n\n    init() {\n        this.form.addEventListener('submit', (e) => {\n            // console.log(this.form);\n            e.preventDefault();\n            this.login();\n        });\n    }\n\n    async login() {\n        const password = this.passInput.value.trim();\n\n        if (!password) {\n            alert('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å');\n            return;\n        }\n\n        try {\n            const response = await fetch(this.apiUrl, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ password })\n            });\n\n            const result = await response.json();\n\n            if (result.data?.success) {\n                const token = result.data.token;\n                const expires = Date.now() + result.data.expires_in * 1000;\n\n                localStorage.setItem(this.tokenKey, token);\n                localStorage.setItem(this.expireKey, expires);\n\n                console.log('[AUTH] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞. –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω');\n                window.location.href = '/admin.html'; // –∏–ª–∏ –Ω—É–∂–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞\n            } else {\n                alert(result.data.message || '–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');\n            }\n\n        } catch (error) {\n            console.error('[AUTH] –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);\n            alert('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');\n        }\n    }\n\n    static logout() {\n        localStorage.removeItem('admin_token');\n        localStorage.removeItem('admin_token_expires');\n        window.location.href = '/auth.html';\n    }\n\n    static isAuthenticated() {\n        const token = localStorage.getItem('admin_token');\n        const expires = localStorage.getItem('admin_token_expires');\n        return token && expires && Date.now() < Number(expires);\n    }\n\n    static getToken() {\n        return localStorage.getItem('admin_token');\n    }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (AdminAuth);\n\n\n//# sourceURL=webpack://vitaliy.wp.dev/./src/assets/js/auth/adminAuth.js?")}},__webpack_module_cache__={};function __webpack_require__(n){var e=__webpack_module_cache__[n];return void 0!==e||(e=__webpack_module_cache__[n]={exports:{}},__webpack_modules__[n].call(e.exports,e,e.exports,__webpack_require__)),e.exports}__webpack_require__.m=__webpack_modules__,!function(){var i=[];__webpack_require__.O=function(n,e,t,s){if(!e){for(var a=1/0,r=0;r<i.length;r++){for(var o,e=i[r][0],t=i[r][1],s=i[r][2],l=!0,_=0;_<e.length;_++)(!1&s||s<=a)&&Object.keys(__webpack_require__.O).every(function(n){return __webpack_require__.O[n](e[_])})?e.splice(_--,1):(l=!1,s<a&&(a=s));l&&(i.splice(r--,1),void 0!==(o=t()))&&(n=o)}return n}s=s||0;for(var r=i.length;0<r&&i[r-1][2]>s;r--)i[r]=i[r-1];i[r]=[e,t,s]}}(),__webpack_require__.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},__webpack_require__.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},!function(){function n(n,e){var t,s,a,r=e[0],o=e[1],l=e[2],_=0;if(r.some(function(n){return 0!==i[n]})){for(t in o)__webpack_require__.o(o,t)&&(__webpack_require__.m[t]=o[t]);l&&(a=l(__webpack_require__))}for(n&&n(e);_<r.length;_++)s=r[_],__webpack_require__.o(i,s)&&i[s]&&i[s][0](),i[s]=0;return __webpack_require__.O(a)}var i={admin:0},e=(__webpack_require__.O.j=function(n){return 0===i[n]},self.webpackChunkvitaliy_wp_dev=self.webpackChunkvitaliy_wp_dev||[]);e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))}();var __webpack_exports__=__webpack_require__.O(void 0,["common"],function(){return __webpack_require__("./src/assets/js/admin.js")});__webpack_require__.O(__webpack_exports__)}();